<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spool Information</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .spool-card {
            background: white;
            border-radius: 16px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.15);
            max-width: 400px;
            width: 100%;
            overflow: hidden;
            position: relative;
        }

        .card-header {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 20px;
            text-align: center;
            border-bottom: 1px solid #e1e5e9;
        }

        .spool-ids {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
        }

        .spool-id, .tag-id {
            font-weight: 700;
            font-size: 16px;
            color: #2c3e50;
        }

        .dates {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: #7f8c8d;
        }

        .date-item {
            display: flex;
            flex-direction: column;
        }

        .date-line {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .time-line {
            font-size: 10px;
            color: #95a5a6;
            margin-top: 2px;
            margin-left: 0;
        }

        .card-body {
            padding: 20px;
        }

        .info-band {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 15px;
        }

        .slicer-section {
            margin-bottom: 25px;
        }

        .slicer-item {
            text-align: center;
            padding: 12px;
            border-radius: 8px;
            background: #f8f9fa;
            width: 100%;
        }

        .info-item {
            text-align: center;
            padding: 8px;
            border-radius: 8px;
            background: #f8f9fa;
        }

        .info-label {
            font-size: 10px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: #6c757d;
            margin-bottom: 2px;
        }

        .info-value {
            font-weight: 600;
            font-size: 14px;
            color: #2c3e50;
        }

        .material {
            background: #e3f2fd;
            color: #1565c0;
        }

        .spool-visual {
            text-align: center;
            margin: 25px 0;
        }

        .spool-circle {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            margin: 0 auto 15px;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .spool-hole {
            width: 50px;
            height: 50px;
            background: white;
            border-radius: 50%;
            border: 2px solid #e1e5e9;
        }

        .color-name {
            font-weight: 600;
            font-size: 18px;
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .color-code {
            font-family: 'Courier New', monospace;
            font-size: 12px;
            color: #7f8c8d;
            background: #f8f9fa;
            padding: 4px 8px;
            border-radius: 4px;
            display: inline-block;
        }

        .weight-section {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 15px;
            margin: 20px 0;
        }

        .weight-title {
            font-weight: 600;
            font-size: 14px;
            color: #2c3e50;
            margin-bottom: 12px;
            text-align: center;
        }

        .weight-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 10px;
        }

        .weight-item {
            text-align: center;
            padding: 8px;
            background: white;
            border-radius: 6px;
        }

        .weight-label {
            font-size: 10px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: #6c757d;
            margin-bottom: 4px;
        }

        .weight-value {
            font-weight: 600;
            font-size: 14px;
            color: #2c3e50;
        }

        .notes-section {
            margin-top: 20px;
        }

        .notes-title {
            font-weight: 600;
            font-size: 14px;
            color: #2c3e50;
            margin-bottom: 8px;
        }

        .notes-content {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 12px;
            font-size: 14px;
            color: #495057;
            line-height: 1.4;
            border-left: 4px solid #dee2e6;
        }

        .future-section {
            margin-top: 15px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            border: 2px dashed #dee2e6;
            text-align: center;
            color: #6c757d;
            font-size: 12px;
        }

                    @media (max-width: 480px) {
            body {
                padding: 5px;
            }
            
            .spool-card {
                max-width: 100%;
            }
            
            .card-header, .card-body {
                padding: 15px;
            }
            
            .info-band {
                grid-template-columns: 1fr;
                gap: 8px;
            }
            
            .spool-circle {
                width: 100px;
                height: 100px;
            }
            
            .spool-hole {
                width: 40px;
                height: 40px;
            }
        }
    </style>
</head>
<body>
    <div class="spool-card">
        <div class="card-header">
            <div class="spool-ids">
                <div class="spool-id" id="spoolId">Spool: --</div>
                <div class="tag-id" id="tagId">Tag: --</div>
            </div>
            <div class="dates">
                <div class="date-item">
                    <div class="date-line">
                        <span>Added:</span>
                        <span id="addedDate">--</span>
                    </div>
                    <div style="display: none;" class="time-line" id="addedTime">--</div>
                </div>
                <div class="date-item">
                    <div class="date-line">
                        <span>Encoded:</span>
                        <span id="encodedDate">--</span>
                    </div>
                    <div style="display: none;" class="time-line" id="encodedTime">--</div>
                </div>
            </div>
        </div>

        <div class="card-body">
            <div class="info-band">
                <div class="info-item material" id="materialItem">
                    <div class="info-label">Material</div>
                    <div class="info-value" id="material">--</div>
                </div>
                <div class="info-item" id="brandItem">
                    <div class="info-label">Brand</div>
                    <div class="info-value" id="brand">--</div>
                </div>
            </div>

            <div class="slicer-section" id="slicerSection">
                <div class="slicer-item">
                    <div class="info-label">Slicer Profile</div>
                    <div class="info-value" id="slicer">--</div>
                </div>
            </div>

            <div class="spool-visual">
                <div class="spool-circle" id="spoolCircle">
                    <div class="spool-hole"></div>
                </div>
                <div class="color-name" id="colorName">--</div>
                <div class="color-code" id="colorCode">--</div>
            </div>

            <div class="weight-section">
                <div class="weight-title">Weight Information</div>
                <div class="weight-grid">
                    <div class="weight-item" id="weightLabelItem">
                        <div class="weight-label">Label</div>
                        <div class="weight-value" id="weightLabel">--</div>
                    </div>
                    <div class="weight-item" id="weightEmptyItem">
                        <div class="weight-label">Empty</div>
                        <div class="weight-value" id="weightEmpty">--</div>
                    </div>
                    <div class="weight-item" id="weightFullItem">
                        <div class="weight-label">Full</div>
                        <div class="weight-value" id="weightFull">--</div>
                    </div>
                </div>
            </div>

            <div class="notes-section" id="notesSection" style="display: none;">
                <div class="notes-title">Notes</div>
                <div class="notes-content" id="notes"></div>
            </div>

            <!-- Reserved space for future features -->
            <div class="future-section" style="display: none;">
                <div>Real-time Weight Data</div>
                <div style="margin-top: 8px;">Last Dried Date</div>
                <div style="margin-top: 8px;">Pressure Advance Settings</div>
            </div>
        </div>
    </div>

    <script>
        function getUrlParams() {
            const params = new URLSearchParams(window.location.search);
            return {
                DE: params.get('DE'),
                DA: params.get('DA'),
                TG: params.get('TG'),
                ID: params.get('ID'),
                M: params.get('M'),
                B: params.get('B'),
                WL: params.get('WL'),
                WE: params.get('WE'),
                WF: params.get('WF'),
                SN: params.get('SN'),
                CC: params.get('CC'),
                CN: params.get('CN'),
                N: params.get('N')
            };
        }

        function formatDate(unixTimestamp) {
            if (!unixTimestamp) return { date: '--', time: '--' };
            const date = new Date(parseInt(unixTimestamp) * 1000);
            return {
                date: date.toLocaleDateString(navigator.language, {
                    year: 'numeric',
                    month: 'short',
                    day: 'numeric'
                }),
                time: date.toLocaleTimeString(navigator.language, {
                    hour: '2-digit',
                    minute: '2-digit'
                })
            };
        }

        function formatWeight(weight) {
            if (!weight) return '--';
            return weight + 'g';
        }

        function hexToRgba(hex) {
            if (!hex || hex.length !== 8) return null;
            const r = parseInt(hex.substr(0, 2), 16);
            const g = parseInt(hex.substr(2, 2), 16);
            const b = parseInt(hex.substr(4, 2), 16);
            const a = parseInt(hex.substr(6, 2), 16) / 255;
            return `rgba(${r}, ${g}, ${b}, ${a})`;
        }

        function hideEmptyElements(elementId, value) {
            // Keep layout consistent - don't hide elements, just show dashes
            return;
        }

        function populateData() {
            const params = getUrlParams();

            // Spool and Tag IDs
            if (params.ID) {
                document.getElementById('spoolId').textContent = `Spool: ${params.ID}`;
            }
            if (params.TG) {
                document.getElementById('tagId').textContent = `Tag: ${params.TG}`;
            }

            // Dates
            const addedDateInfo = formatDate(params.DA);
            const encodedDateInfo = formatDate(params.DE);
            
            document.getElementById('addedDate').textContent = addedDateInfo.date;
            document.getElementById('addedTime').textContent = addedDateInfo.time;
            document.getElementById('encodedDate').textContent = encodedDateInfo.date;
            document.getElementById('encodedTime').textContent = encodedDateInfo.time;

            // Material, Brand, Slicer
            document.getElementById('material').textContent = params.M || '--';
            document.getElementById('brand').textContent = params.B || '--';
            document.getElementById('slicer').textContent = params.SN || '--';

            // Color
            document.getElementById('colorName').textContent = params.CN || '--';

            if (params.CC) {
                const rgba = hexToRgba(params.CC);
                if (rgba) {
                    document.getElementById('spoolCircle').style.background = rgba;
                    document.getElementById('colorCode').textContent = `#${params.CC}`;
                } else {
                    document.getElementById('colorCode').textContent = '--';
                }
            } else {
                document.getElementById('colorCode').textContent = '--';
            }

            // Weights
            document.getElementById('weightLabel').textContent = formatWeight(params.WL);
            document.getElementById('weightEmpty').textContent = formatWeight(params.WE);
            document.getElementById('weightFull').textContent = formatWeight(params.WF);

            // Notes
            if (params.N) {
                document.getElementById('notes').textContent = decodeURIComponent(params.N);
                document.getElementById('notesSection').style.display = 'block';
            }
        }

        // Example data for demonstration
        function loadExampleData() {
            // Simulate URL parameters with example data
            const exampleParams = {
                DE: '1703721600', // Dec 28, 2023
                DA: '1703635200', // Dec 27, 2023
                TG: 'TAG-001',
                ID: 'SP-PLA-RED-2023',
                M: 'PLA',
                B: 'Prusament',
                WL: '1000',
                WE: '240',
                WF: '1240',
                SN: 'PrusaSlicer Generic PLA',
                CC: 'FF3333FF', // Red color
                CN: 'Fire Engine Red',
                N: 'High quality PLA, perfect for detailed prints. Store in dry conditions.'
            };

            // Override getUrlParams to return example data
            window.getUrlParams = function() {
                return exampleParams;
            };

            populateData();
        }

        // Initialize when page loads - use example data for demonstration
        document.addEventListener('DOMContentLoaded', function() {
            // Check if we have actual URL parameters
            const urlParams = new URLSearchParams(window.location.search);
            if (urlParams.toString() === '') {
                // No URL parameters, load example data
                loadExampleData();
            } else {
                // Use actual URL parameters
                populateData();
            }
        });
    </script>
</body>
</html>
